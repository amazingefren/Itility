<div class="g-signin2" data-onsuccess="onSignIn"></div>
<a href="#" onclick="signOut();">Sign out</a>

<div class="container">
    <div class="row">
        <div class="card blue-grey darken-1" id="create_bill">
            <div class="card-content white-text">
                <span class="card-title">New Bill</span>

            </div>
            <div class="card-action">
                <div class="input-field col s3">
                    <i class="material-icons prefix">attach_money</i>
                    <input id="icon_prefix" type="text" class="validate">
                    <label for="icon_prefix">Amount</label>
                </div>
                <div class="input-field col s3">
                    <input type="text" class="datepicker">
                </div>

                <div class="input-field col s3">
                    <!-- Dropdown Trigger -->
                    <a class='dropdown-trigger btn' href='#' data-target='dropdown1'>Utility</a>

                    <!-- Dropdown Structure -->
                    <ul id='dropdown1' class='dropdown-content'>
                        <li><a href="#!">Water</a></li>
                        <li><a href="#!">Example..</a></li>

                    </ul>
                </div>

                <div class="input-field col s3">
                    <a class="btn-floating btn-large waves-effect waves-light red"><i class="material-icons">add</i></a>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="card">
            <div class="card-image waves-effect waves-block waves-light">
                <img class="activator"
                    src="https://www.xcelenergy.com/staticfiles/xe-responsive/assets/images/logo.png">
            </div>
            <div class="card-content">
                <span class="card-title activator grey-text text-darken-4">Card Title<i
                        class="material-icons right">more_vert</i></span>
                <p><a href="#">This is a link</a></p>
            </div>
            <div class="card-reveal">
                <span class="card-title grey-text text-darken-4">Card Title<i
                        class="material-icons right">close</i></span>
                <p>Here is some more information about this product that is only revealed once clicked on.</p>
            </div>
        </div>



        <div class="card">
            <div class="card-image waves-effect waves-block waves-light">
                <img class="activator" src="images/office.jpg">
            </div>
            <div class="card-content">
                <span class="card-title activator grey-text text-darken-4">Card Title<i
                        class="material-icons right">more_vert</i></span>
                <p><a href="#">This is a link</a></p>
            </div>
            <div class="card-reveal">
                <span class="card-title grey-text text-darken-4">Card Title<i
                        class="material-icons right">close</i></span>
                <p>Here is some more information about this product that is only revealed once clicked on.</p>
            </div>
        </div>
    </div>

    <script>
        function onSignIn(googleUser) {
            console.log("CALLED ONSIGNIN")
            var profile = googleUser.getBasicProfile();
            console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
            console.log('Name: ' + profile.getName());
            console.log('Image URL: ' + profile.getImageUrl());
            console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not
            const email = profile.getEmail();

            if (profile) { //if user is signed in
                $.post("/home", { email: email }, res => {
                    console.log(res)
                })
            }



            // THIS WORKS profile ? console.log("pass") : console.log("fail");

            $.get(`/api/user/${email}`, response => {
                if (response === "OK") {
                    $.post("/home", { email: email }, emailresponse => {
                        console.log(emailresponse)
                    })
                } else {
                    console.log(`response = ${response}`)
                }
            })
        }
        function signOut() {
            const auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
                console.log('User signed out.');
            });
        }
    </script>
</div>

<script src="/js/dropdown.js"></script>